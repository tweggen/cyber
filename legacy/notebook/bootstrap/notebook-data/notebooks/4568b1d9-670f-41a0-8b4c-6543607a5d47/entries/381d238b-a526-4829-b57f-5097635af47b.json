{
  "id": "381d238b-a526-4829-b57f-5097635af47b",
  "content": "TASK: Define the coherence model - how entries cluster and relate.\n\nCONTEXT: Integration cost measures disruption to existing knowledge. To compute this, we need a model of what \"coherent\" looks like. This task defines that model computationally.\n\nIMPLEMENTATION:\n\n1. Topic Clustering:\n- Extract keywords from text entries (simple tokenization, stop word removal)\n- TF-IDF weighting for keyword importance\n- Cluster entries by keyword similarity (cosine similarity threshold)\n- Non-text entries cluster by explicit topic tag and reference proximity\n\n2. Reference Density:\n- Within each cluster, compute reference density = edges / possible_edges\n- High density = tightly connected knowledge\n- Low density = loosely related entries\n\n3. Coherence State:\n- CoherenceSnapshot { clusters: Vec<Cluster>, timestamp: CausalPosition }\n- Cluster { id, topic_keywords: Vec<String>, entry_ids: Vec<EntryId>, reference_density: f64 }\n- Store as materialized state, updated on each write\n\n4. Cluster Assignment:\n- assign_to_cluster(entry, current_state) -> Option<ClusterId>\n- Returns None if entry doesnt fit any cluster (potential orphan)\n- Threshold for similarity configurable\n\nSTORAGE:\n- CoherenceSnapshot stored in PostgreSQL (JSONB) or separate table\n- One snapshot per notebook, updated atomically with writes\n\nACCEPTANCE:\n- Clustering algorithm implemented and tested\n- TF-IDF computation works on text entries\n- Reference density computed correctly\n- Snapshot persistence works\n- Unit tests for clustering edge cases\n\nDEPENDENCY: Phase 1 complete. First task of Phase 2.\n\nREFERENCES: See entropy model entry for conceptual foundation.",
  "content_type": "text/plain",
  "topic": "task-assignment 2-1",
  "references": [
    "509be5e4-b5e7-4f16-845e-b17e63b44605",
    "bb322ced-1f15-44ba-a975-5b46c56e306c"
  ],
  "revision_of": null,
  "author": "orchestrator",
  "causal_position": {
    "sequence": 47,
    "activity_context": {
      "entries_since_last_by_author": 19,
      "total_notebook_entries": 46,
      "recent_entropy": 18.6
    }
  },
  "created": "2026-02-05T10:56:05.760897+00:00",
  "integration_cost": {
    "entries_revised": 0,
    "references_broken": 0,
    "catalog_shift": 0.5,
    "orphan": false
  }
}